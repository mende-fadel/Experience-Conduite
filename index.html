<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Saisie Exp√©rience - Fadelos</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header>
        <nav>
            <div class="logo">
                üöó Experience Conduite
            </div>
            <div class="nav-links">
                <a href="index.html" class="active">Saisir</a>
                <a href="slideImage.html">Voir le Bilan</a>
            </div>
        </nav>
    </header>

    <div class="container">
        <div class="card">
            <h1>Nouvelle Session</h1>
            <form id="driveForm">
                <div class="form-group full-width">
                    <label for="name">Conducteur</label>
                    <input type="text" id="name" placeholder="Nom complet" required>
                </div>
                
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" placeholder="exemple@mail.com" required>
                </div>
                <div class="form-group">
                    <label for="tel">T√©l√©phone</label>
                    <input type="tel" id="tel" placeholder="06 00 00 00 00">
                </div>

                <div class="form-group">
                    <label for="dateCon">Date</label>
                    <input type="date" id="dateCon" required>
                </div>
                <div class="form-group">
                    <label for="kilom">Distance (Km)</label>
                    <input type="number" id="kilom" step="0.1" min="0" required>
                </div>

                <div class="form-group">
                    <label for="hdepart">Heure D√©part</label>
                    <input type="time" id="hdepart" required>
                </div>
                <div class="form-group">
                    <label for="hfin">Heure Arriv√©e</label>
                    <input type="time" id="hfin" required>
                </div>

                <div class="form-group">
                    <label for="idMeteo">M√©t√©o</label>
                    <select id="idMeteo" required>
                        <option value="">-- Choisir --</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="idVoiture">V√©hicule</label>
                    <select id="idVoiture" required>
                        <option value="">-- Choisir --</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="idRoute">Type de Route</label>
                    <select id="idRoute" required>
                        <option value="">-- Choisir --</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="idMoniteur">Moniteur</label>
                    <select id="idMoniteur" required>
                        <option value="">-- Choisir --</option>
                    </select>
                </div>

                <div class="btn-container">
                    <button type="button" class="btn-primary" onclick="saveDrive()">Enregistrer la session</button>
                    <button type="reset" class="btn-secondary">Effacer</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // --- DONN√âES DE R√âF√âRENCE ---
        const dataRef = {
            meteo: [
                {id: 1, label: "Soleil ‚òÄÔ∏è"}, {id: 2, label: "Neige ‚ùÑÔ∏è"}, {id: 3, label: "Pluie üåßÔ∏è"},
                {id: 4, label: "Brouillard üå´Ô∏è"}, {id: 5, label: "Verglas üßä"}, {id: 6, label: "Orage ‚õàÔ∏è"},
                {id: 7, label: "Nuageux ‚òÅÔ∏è"}, {id: 8, label: "Temp√™te de sable üèúÔ∏è"}
            ],
            voitures: [
                {id: 1, label: "Mercedes"}, {id: 2, label: "Audi"}, {id: 3, label: "Peugeot"},
                {id: 4, label: "Renault"}, {id: 5, label: "BMW"}, {id: 6, label: "Jeep"}, {id: 7, label: "Toyota"}
            ],
            routes: [
                {id: 1, label: "Autoroute"}, {id: 2, label: "Route Communale"},
                {id: 3, label: "Route Nationale"}, {id: 4, label: "Route Europ√©enne"}, {id: 5, label: "Route D√©partementale"}
            ],
            moniteurs: [
                {id: 1, label: "LEFEBRE Jean"}, {id: 2, label: "LOUIS Jean"},
                {id: 3, label: "CLAUDE Leroi"}, {id: 4, label: "MENSANH Kodjo"}
            ]
        };

        // --- INITIALISATION ---
        window.onload = function() {
            populateSelect('idMeteo', dataRef.meteo);
            populateSelect('idVoiture', dataRef.voitures);
            populateSelect('idRoute', dataRef.routes);
            populateSelect('idMoniteur', dataRef.moniteurs);
        };

        function populateSelect(elementId, array) {
            const select = document.getElementById(elementId);
            array.forEach(item => {
                const option = document.createElement('option');
                option.value = item.id;
                option.textContent = item.label;
                select.appendChild(option);
            });
        }

        // --- SAUVEGARDE ---
        function saveDrive() {
            // R√©cup√©ration des valeurs
            const form = document.getElementById('driveForm');
            
            // Validation simple HTML5
            if (!form.checkValidity()) {
                alert("Veuillez remplir tous les champs obligatoires.");
                return;
            }

            const newEntry = {
                id: Date.now(), // ID unique bas√© sur l'heure
                nom: document.getElementById('name').value,
                email: document.getElementById('email').value,
                tel: document.getElementById('tel').value,
                date: document.getElementById('dateCon').value,
                hDepart: document.getElementById('hdepart').value,
                hFin: document.getElementById('hfin').value,
                km: parseFloat(document.getElementById('kilom').value),
                meteoId: document.getElementById('idMeteo').value,
                voitureId: document.getElementById('idVoiture').value,
                routeId: document.getElementById('idRoute').value,
                moniteurId: document.getElementById('idMoniteur').value
            };

            // Gestion du LocalStorage
            let history = JSON.parse(localStorage.getItem('listExperience')) || [];
            history.push(newEntry);
            localStorage.setItem('listExperience', JSON.stringify(history));

            alert('‚úÖ Exp√©rience enregistr√©e avec succ√®s !');
            form.reset();
            
            // Optionnel : rediriger vers le bilan
            // window.location.href = "slideImage.html";
        }
    </script>
</body>
</html>